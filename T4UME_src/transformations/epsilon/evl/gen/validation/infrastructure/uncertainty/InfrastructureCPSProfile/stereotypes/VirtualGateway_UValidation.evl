
/*
Autogenerated Uncertainty Detection Rule (UDR).
The UDR aims at detecting potential infrastructural uncertainties caused by missing
information on UML Model.

This rule check the following stereotype: 
InfrastructureCPSProfile::VirtualGateway. 

VirtualGateway defines the following properties:
-	InfrastructureCPSProfile::VirtualUnit::virtualActuators
-	InfrastructureCPSProfile::VirtualUnit::virtualSensors
-	InfrastructureCPSProfile::VirtualUnit::ownedVirtualUnits
-	InfrastructureCPSProfile::VirtualUnit::deployedOn
-	InfrastructureCPSProfile::Unit::id
-	InfrastructureCPSProfile::Unit::location
-	InfrastructureCPSProfile::Unit::description
-	InfrastructureCPSProfile::Unit::ownedUnits
-	InfrastructureCPSProfile::Unit::hasTimestampMechanism
-	InfrastructureCPSProfile::Unit::timestampMaxLatency
-	InfrastructureCPSProfile::Unit::isSafetyCritical
-	InfrastructureCPSProfile::InfrastructureElement::infrastructureInterface
*/
//libraries
import "../../../../../../../eol/library/gen/profiles/InfrastructureUncertaintyProfile.eol";
import "../../../../../../../eol/library/gen/profiles/InfrastructureCPSProfile.eol";
import "../../../../../../../eol/library/gen/profiles/CoreProfile.eol";
import "../../../../../../../eol/library/gen/profiles/InternalUProfileLibrary.eol";
import "../../../../../../../eol/library/gen/uncertainties/UncertaintyTaxonomyLibrary.eol";

pre {
var plugin : new Native("at.ac.tuwien.dsg.T4UME");
var UMLUtil = plugin.getUMLUtil();
var ModelerAgent = plugin.getModelerAgent();
var infrastructureUncertaintyProfile = Profile.all.selectOne(e|e.name = "InfrastructureUncertaintyProfile");
var infrastructureCPSProfile = Profile.all.selectOne(e|e.name = "InfrastructureCPSProfile");
var internalUProfileLibrary = Profile.all.selectOne(e|e.name = "InternalUProfileLibrary");
var coreProfile = Profile.all.selectOne(e|e.name = "CoreProfile");

}

context VirtualGateway {
	
	critique virtualActuators_Specification {
	
		guard {
			var condition = self.virtualActuators.isKindOf(Collection);
			return condition;
		}
		
		check {
			var baseElement = UMLUtil.getBaseElement(self);
			return not self.virtualActuators.isEmpty();
		}
		
		message: "Missing virtualActuators on VirtualGateway applied to "+ baseElement.getQualifiedName()		
		fix {
			title : "Generate StorageUncertainty State in " + baseElement.getQualifiedName()
			do {
				transaction {
					//check if the behaviored classifier defines a state machine or not
					var owned_behaviors = baseElement.getOwnedBehaviors();
					
					/*
					var owned_statemachines = owned_behaviors.select(e|e.type.getName()="StateMachine");
					if(not (owned_statemachines.isEmpty()) ){
						UserInput.inform(baseElement.name + "contains " + owned_statemachines.size().asString() + "state machine(s)");
					}
					*/
					baseElement.createStorageUncertaintyStateMachine();
					var storageUncertainty = coreProfile.getStorageUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(storageUncertainty) 
						and not (baseElement.isStereotypeApplied(storageUncertainty))){
						baseElement.applyStereotype(storageUncertainty);
					}

				}
			}
		}
		fix {
			title : "Generate ActuationUncertainty State in " + baseElement.getQualifiedName()
			do {
				transaction {
					//check if the behaviored classifier defines a state machine or not
					var owned_behaviors = baseElement.getOwnedBehaviors();
					
					/*
					var owned_statemachines = owned_behaviors.select(e|e.type.getName()="StateMachine");
					if(not (owned_statemachines.isEmpty()) ){
						UserInput.inform(baseElement.name + "contains " + owned_statemachines.size().asString() + "state machine(s)");
					}
					*/
					baseElement.createActuationUncertaintyStateMachine();
					var actuationUncertainty = coreProfile.getActuationUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(actuationUncertainty) 
						and not (baseElement.isStereotypeApplied(actuationUncertainty))){
						baseElement.applyStereotype(actuationUncertainty);
					}

				}
			}
		}
		fix {
			title : "Generate UncertaintyFamily State in " + baseElement.getQualifiedName()
			do {
				transaction {
					//check if the behaviored classifier defines a state machine or not
					var owned_behaviors = baseElement.getOwnedBehaviors();
					
					/*
					var owned_statemachines = owned_behaviors.select(e|e.type.getName()="StateMachine");
					if(not (owned_statemachines.isEmpty()) ){
						UserInput.inform(baseElement.name + "contains " + owned_statemachines.size().asString() + "state machine(s)");
					}
					*/
					baseElement.createUncertaintyFamilyStateMachine();
					var uncertaintyFamily = coreProfile.getUncertaintyFamilyStereotype();
					
					if(baseElement.isStereotypeApplicable(uncertaintyFamily) 
						and not (baseElement.isStereotypeApplied(uncertaintyFamily))){
						baseElement.applyStereotype(uncertaintyFamily);
					}

				}
			}
		}
		fix {
			title : "Generate GovernanceUncertainty State in " + baseElement.getQualifiedName()
			do {
				transaction {
					//check if the behaviored classifier defines a state machine or not
					var owned_behaviors = baseElement.getOwnedBehaviors();
					
					/*
					var owned_statemachines = owned_behaviors.select(e|e.type.getName()="StateMachine");
					if(not (owned_statemachines.isEmpty()) ){
						UserInput.inform(baseElement.name + "contains " + owned_statemachines.size().asString() + "state machine(s)");
					}
					*/
					baseElement.createGovernanceUncertaintyStateMachine();
					var governanceUncertainty = coreProfile.getGovernanceUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(governanceUncertainty) 
						and not (baseElement.isStereotypeApplied(governanceUncertainty))){
						baseElement.applyStereotype(governanceUncertainty);
					}

				}
			}
		}
		fix {
			title : "Generate DataDeliveryUncertainty State in " + baseElement.getQualifiedName()
			do {
				transaction {
					//check if the behaviored classifier defines a state machine or not
					var owned_behaviors = baseElement.getOwnedBehaviors();
					
					/*
					var owned_statemachines = owned_behaviors.select(e|e.type.getName()="StateMachine");
					if(not (owned_statemachines.isEmpty()) ){
						UserInput.inform(baseElement.name + "contains " + owned_statemachines.size().asString() + "state machine(s)");
					}
					*/
					baseElement.createDataDeliveryUncertaintyStateMachine();
					var dataDeliveryUncertainty = coreProfile.getDataDeliveryUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(dataDeliveryUncertainty) 
						and not (baseElement.isStereotypeApplied(dataDeliveryUncertainty))){
						baseElement.applyStereotype(dataDeliveryUncertainty);
					}

				}
			}
		}
		fix {
			title : "Generate ElasticityUncertainty State in " + baseElement.getQualifiedName()
			do {
				transaction {
					//check if the behaviored classifier defines a state machine or not
					var owned_behaviors = baseElement.getOwnedBehaviors();
					
					/*
					var owned_statemachines = owned_behaviors.select(e|e.type.getName()="StateMachine");
					if(not (owned_statemachines.isEmpty()) ){
						UserInput.inform(baseElement.name + "contains " + owned_statemachines.size().asString() + "state machine(s)");
					}
					*/
					baseElement.createElasticityUncertaintyStateMachine();
					var elasticityUncertainty = coreProfile.getElasticityUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(elasticityUncertainty) 
						and not (baseElement.isStereotypeApplied(elasticityUncertainty))){
						baseElement.applyStereotype(elasticityUncertainty);
					}

				}
			}
		}
		fix {
			title : "Generate ExecutionEnvironmentUncertainty State in " + baseElement.getQualifiedName()
			do {
				transaction {
					//check if the behaviored classifier defines a state machine or not
					var owned_behaviors = baseElement.getOwnedBehaviors();
					
					/*
					var owned_statemachines = owned_behaviors.select(e|e.type.getName()="StateMachine");
					if(not (owned_statemachines.isEmpty()) ){
						UserInput.inform(baseElement.name + "contains " + owned_statemachines.size().asString() + "state machine(s)");
					}
					*/
					baseElement.createExecutionEnvironmentUncertaintyStateMachine();
					var executionEnvironmentUncertainty = coreProfile.getExecutionEnvironmentUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(executionEnvironmentUncertainty) 
						and not (baseElement.isStereotypeApplied(executionEnvironmentUncertainty))){
						baseElement.applyStereotype(executionEnvironmentUncertainty);
					}

				}
			}
		}
		
	}

	critique virtualActuatorsSpecification {
	
		guard {
			var condition = not self.virtualActuators.isKindOf(Collection);
			return condition;
		} 
		
		check {
			var baseElement = UMLUtil.getBaseElement(self);
			return not self.virtualActuators.isEmpty();
		}		
		message: "Constraint virtualActuatorsIsDefined failed on VirtualGateway "+ baseElement.getName() +". It causes this uncertainty bla bla bla"		
		fix {
			title : "Create Infrastructure Uncertainty State to " + baseElement.getName()
			do {
				transaction {
					baseElement.createStorageUncertaintyStateMachine();
					var storageUncertainty = coreProfile.getStorageUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(storageUncertainty) 
						and not (baseElement.isStereotypeApplied(storageUncertainty))){
						baseElement.applyStereotype(storageUncertainty);
					}
				}
			}
		}
		fix {
			title : "Create Infrastructure Uncertainty State to " + baseElement.getName()
			do {
				transaction {
					baseElement.createActuationUncertaintyStateMachine();
					var actuationUncertainty = coreProfile.getActuationUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(actuationUncertainty) 
						and not (baseElement.isStereotypeApplied(actuationUncertainty))){
						baseElement.applyStereotype(actuationUncertainty);
					}
				}
			}
		}
		fix {
			title : "Create Infrastructure Uncertainty State to " + baseElement.getName()
			do {
				transaction {
					baseElement.createUncertaintyFamilyStateMachine();
					var uncertaintyFamily = coreProfile.getUncertaintyFamilyStereotype();
					
					if(baseElement.isStereotypeApplicable(uncertaintyFamily) 
						and not (baseElement.isStereotypeApplied(uncertaintyFamily))){
						baseElement.applyStereotype(uncertaintyFamily);
					}
				}
			}
		}
		fix {
			title : "Create Infrastructure Uncertainty State to " + baseElement.getName()
			do {
				transaction {
					baseElement.createGovernanceUncertaintyStateMachine();
					var governanceUncertainty = coreProfile.getGovernanceUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(governanceUncertainty) 
						and not (baseElement.isStereotypeApplied(governanceUncertainty))){
						baseElement.applyStereotype(governanceUncertainty);
					}
				}
			}
		}
		fix {
			title : "Create Infrastructure Uncertainty State to " + baseElement.getName()
			do {
				transaction {
					baseElement.createDataDeliveryUncertaintyStateMachine();
					var dataDeliveryUncertainty = coreProfile.getDataDeliveryUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(dataDeliveryUncertainty) 
						and not (baseElement.isStereotypeApplied(dataDeliveryUncertainty))){
						baseElement.applyStereotype(dataDeliveryUncertainty);
					}
				}
			}
		}
		fix {
			title : "Create Infrastructure Uncertainty State to " + baseElement.getName()
			do {
				transaction {
					baseElement.createElasticityUncertaintyStateMachine();
					var elasticityUncertainty = coreProfile.getElasticityUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(elasticityUncertainty) 
						and not (baseElement.isStereotypeApplied(elasticityUncertainty))){
						baseElement.applyStereotype(elasticityUncertainty);
					}
				}
			}
		}
		fix {
			title : "Create Infrastructure Uncertainty State to " + baseElement.getName()
			do {
				transaction {
					baseElement.createExecutionEnvironmentUncertaintyStateMachine();
					var executionEnvironmentUncertainty = coreProfile.getExecutionEnvironmentUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(executionEnvironmentUncertainty) 
						and not (baseElement.isStereotypeApplied(executionEnvironmentUncertainty))){
						baseElement.applyStereotype(executionEnvironmentUncertainty);
					}
				}
			}
		}
	}
	
	critique virtualSensors_Specification {
	
		guard {
			var condition = self.virtualSensors.isKindOf(Collection);
			return condition;
		}
		
		check {
			var baseElement = UMLUtil.getBaseElement(self);
			return not self.virtualSensors.isEmpty();
		}
		
		message: "Missing virtualSensors on VirtualGateway applied to "+ baseElement.getQualifiedName()		
		fix {
			title : "Generate StorageUncertainty State in " + baseElement.getQualifiedName()
			do {
				transaction {
					//check if the behaviored classifier defines a state machine or not
					var owned_behaviors = baseElement.getOwnedBehaviors();
					
					/*
					var owned_statemachines = owned_behaviors.select(e|e.type.getName()="StateMachine");
					if(not (owned_statemachines.isEmpty()) ){
						UserInput.inform(baseElement.name + "contains " + owned_statemachines.size().asString() + "state machine(s)");
					}
					*/
					baseElement.createStorageUncertaintyStateMachine();
					var storageUncertainty = coreProfile.getStorageUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(storageUncertainty) 
						and not (baseElement.isStereotypeApplied(storageUncertainty))){
						baseElement.applyStereotype(storageUncertainty);
					}

				}
			}
		}
		fix {
			title : "Generate ActuationUncertainty State in " + baseElement.getQualifiedName()
			do {
				transaction {
					//check if the behaviored classifier defines a state machine or not
					var owned_behaviors = baseElement.getOwnedBehaviors();
					
					/*
					var owned_statemachines = owned_behaviors.select(e|e.type.getName()="StateMachine");
					if(not (owned_statemachines.isEmpty()) ){
						UserInput.inform(baseElement.name + "contains " + owned_statemachines.size().asString() + "state machine(s)");
					}
					*/
					baseElement.createActuationUncertaintyStateMachine();
					var actuationUncertainty = coreProfile.getActuationUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(actuationUncertainty) 
						and not (baseElement.isStereotypeApplied(actuationUncertainty))){
						baseElement.applyStereotype(actuationUncertainty);
					}

				}
			}
		}
		fix {
			title : "Generate UncertaintyFamily State in " + baseElement.getQualifiedName()
			do {
				transaction {
					//check if the behaviored classifier defines a state machine or not
					var owned_behaviors = baseElement.getOwnedBehaviors();
					
					/*
					var owned_statemachines = owned_behaviors.select(e|e.type.getName()="StateMachine");
					if(not (owned_statemachines.isEmpty()) ){
						UserInput.inform(baseElement.name + "contains " + owned_statemachines.size().asString() + "state machine(s)");
					}
					*/
					baseElement.createUncertaintyFamilyStateMachine();
					var uncertaintyFamily = coreProfile.getUncertaintyFamilyStereotype();
					
					if(baseElement.isStereotypeApplicable(uncertaintyFamily) 
						and not (baseElement.isStereotypeApplied(uncertaintyFamily))){
						baseElement.applyStereotype(uncertaintyFamily);
					}

				}
			}
		}
		fix {
			title : "Generate GovernanceUncertainty State in " + baseElement.getQualifiedName()
			do {
				transaction {
					//check if the behaviored classifier defines a state machine or not
					var owned_behaviors = baseElement.getOwnedBehaviors();
					
					/*
					var owned_statemachines = owned_behaviors.select(e|e.type.getName()="StateMachine");
					if(not (owned_statemachines.isEmpty()) ){
						UserInput.inform(baseElement.name + "contains " + owned_statemachines.size().asString() + "state machine(s)");
					}
					*/
					baseElement.createGovernanceUncertaintyStateMachine();
					var governanceUncertainty = coreProfile.getGovernanceUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(governanceUncertainty) 
						and not (baseElement.isStereotypeApplied(governanceUncertainty))){
						baseElement.applyStereotype(governanceUncertainty);
					}

				}
			}
		}
		fix {
			title : "Generate DataDeliveryUncertainty State in " + baseElement.getQualifiedName()
			do {
				transaction {
					//check if the behaviored classifier defines a state machine or not
					var owned_behaviors = baseElement.getOwnedBehaviors();
					
					/*
					var owned_statemachines = owned_behaviors.select(e|e.type.getName()="StateMachine");
					if(not (owned_statemachines.isEmpty()) ){
						UserInput.inform(baseElement.name + "contains " + owned_statemachines.size().asString() + "state machine(s)");
					}
					*/
					baseElement.createDataDeliveryUncertaintyStateMachine();
					var dataDeliveryUncertainty = coreProfile.getDataDeliveryUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(dataDeliveryUncertainty) 
						and not (baseElement.isStereotypeApplied(dataDeliveryUncertainty))){
						baseElement.applyStereotype(dataDeliveryUncertainty);
					}

				}
			}
		}
		fix {
			title : "Generate ElasticityUncertainty State in " + baseElement.getQualifiedName()
			do {
				transaction {
					//check if the behaviored classifier defines a state machine or not
					var owned_behaviors = baseElement.getOwnedBehaviors();
					
					/*
					var owned_statemachines = owned_behaviors.select(e|e.type.getName()="StateMachine");
					if(not (owned_statemachines.isEmpty()) ){
						UserInput.inform(baseElement.name + "contains " + owned_statemachines.size().asString() + "state machine(s)");
					}
					*/
					baseElement.createElasticityUncertaintyStateMachine();
					var elasticityUncertainty = coreProfile.getElasticityUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(elasticityUncertainty) 
						and not (baseElement.isStereotypeApplied(elasticityUncertainty))){
						baseElement.applyStereotype(elasticityUncertainty);
					}

				}
			}
		}
		fix {
			title : "Generate ExecutionEnvironmentUncertainty State in " + baseElement.getQualifiedName()
			do {
				transaction {
					//check if the behaviored classifier defines a state machine or not
					var owned_behaviors = baseElement.getOwnedBehaviors();
					
					/*
					var owned_statemachines = owned_behaviors.select(e|e.type.getName()="StateMachine");
					if(not (owned_statemachines.isEmpty()) ){
						UserInput.inform(baseElement.name + "contains " + owned_statemachines.size().asString() + "state machine(s)");
					}
					*/
					baseElement.createExecutionEnvironmentUncertaintyStateMachine();
					var executionEnvironmentUncertainty = coreProfile.getExecutionEnvironmentUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(executionEnvironmentUncertainty) 
						and not (baseElement.isStereotypeApplied(executionEnvironmentUncertainty))){
						baseElement.applyStereotype(executionEnvironmentUncertainty);
					}

				}
			}
		}
		
	}

	critique virtualSensorsSpecification {
	
		guard {
			var condition = not self.virtualSensors.isKindOf(Collection);
			return condition;
		} 
		
		check {
			var baseElement = UMLUtil.getBaseElement(self);
			return not self.virtualSensors.isEmpty();
		}		
		message: "Constraint virtualSensorsIsDefined failed on VirtualGateway "+ baseElement.getName() +". It causes this uncertainty bla bla bla"		
		fix {
			title : "Create Infrastructure Uncertainty State to " + baseElement.getName()
			do {
				transaction {
					baseElement.createStorageUncertaintyStateMachine();
					var storageUncertainty = coreProfile.getStorageUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(storageUncertainty) 
						and not (baseElement.isStereotypeApplied(storageUncertainty))){
						baseElement.applyStereotype(storageUncertainty);
					}
				}
			}
		}
		fix {
			title : "Create Infrastructure Uncertainty State to " + baseElement.getName()
			do {
				transaction {
					baseElement.createActuationUncertaintyStateMachine();
					var actuationUncertainty = coreProfile.getActuationUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(actuationUncertainty) 
						and not (baseElement.isStereotypeApplied(actuationUncertainty))){
						baseElement.applyStereotype(actuationUncertainty);
					}
				}
			}
		}
		fix {
			title : "Create Infrastructure Uncertainty State to " + baseElement.getName()
			do {
				transaction {
					baseElement.createUncertaintyFamilyStateMachine();
					var uncertaintyFamily = coreProfile.getUncertaintyFamilyStereotype();
					
					if(baseElement.isStereotypeApplicable(uncertaintyFamily) 
						and not (baseElement.isStereotypeApplied(uncertaintyFamily))){
						baseElement.applyStereotype(uncertaintyFamily);
					}
				}
			}
		}
		fix {
			title : "Create Infrastructure Uncertainty State to " + baseElement.getName()
			do {
				transaction {
					baseElement.createGovernanceUncertaintyStateMachine();
					var governanceUncertainty = coreProfile.getGovernanceUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(governanceUncertainty) 
						and not (baseElement.isStereotypeApplied(governanceUncertainty))){
						baseElement.applyStereotype(governanceUncertainty);
					}
				}
			}
		}
		fix {
			title : "Create Infrastructure Uncertainty State to " + baseElement.getName()
			do {
				transaction {
					baseElement.createDataDeliveryUncertaintyStateMachine();
					var dataDeliveryUncertainty = coreProfile.getDataDeliveryUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(dataDeliveryUncertainty) 
						and not (baseElement.isStereotypeApplied(dataDeliveryUncertainty))){
						baseElement.applyStereotype(dataDeliveryUncertainty);
					}
				}
			}
		}
		fix {
			title : "Create Infrastructure Uncertainty State to " + baseElement.getName()
			do {
				transaction {
					baseElement.createElasticityUncertaintyStateMachine();
					var elasticityUncertainty = coreProfile.getElasticityUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(elasticityUncertainty) 
						and not (baseElement.isStereotypeApplied(elasticityUncertainty))){
						baseElement.applyStereotype(elasticityUncertainty);
					}
				}
			}
		}
		fix {
			title : "Create Infrastructure Uncertainty State to " + baseElement.getName()
			do {
				transaction {
					baseElement.createExecutionEnvironmentUncertaintyStateMachine();
					var executionEnvironmentUncertainty = coreProfile.getExecutionEnvironmentUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(executionEnvironmentUncertainty) 
						and not (baseElement.isStereotypeApplied(executionEnvironmentUncertainty))){
						baseElement.applyStereotype(executionEnvironmentUncertainty);
					}
				}
			}
		}
	}
	
	critique ownedVirtualUnits_Specification {
	
		guard {
			var condition = self.ownedVirtualUnits.isKindOf(Collection);
			return condition;
		}
		
		check {
			var baseElement = UMLUtil.getBaseElement(self);
			return not self.ownedVirtualUnits.isEmpty();
		}
		
		message: "Missing ownedVirtualUnits on VirtualGateway applied to "+ baseElement.getQualifiedName()		
		fix {
			title : "Generate StorageUncertainty State in " + baseElement.getQualifiedName()
			do {
				transaction {
					//check if the behaviored classifier defines a state machine or not
					var owned_behaviors = baseElement.getOwnedBehaviors();
					
					/*
					var owned_statemachines = owned_behaviors.select(e|e.type.getName()="StateMachine");
					if(not (owned_statemachines.isEmpty()) ){
						UserInput.inform(baseElement.name + "contains " + owned_statemachines.size().asString() + "state machine(s)");
					}
					*/
					baseElement.createStorageUncertaintyStateMachine();
					var storageUncertainty = coreProfile.getStorageUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(storageUncertainty) 
						and not (baseElement.isStereotypeApplied(storageUncertainty))){
						baseElement.applyStereotype(storageUncertainty);
					}

				}
			}
		}
		fix {
			title : "Generate ActuationUncertainty State in " + baseElement.getQualifiedName()
			do {
				transaction {
					//check if the behaviored classifier defines a state machine or not
					var owned_behaviors = baseElement.getOwnedBehaviors();
					
					/*
					var owned_statemachines = owned_behaviors.select(e|e.type.getName()="StateMachine");
					if(not (owned_statemachines.isEmpty()) ){
						UserInput.inform(baseElement.name + "contains " + owned_statemachines.size().asString() + "state machine(s)");
					}
					*/
					baseElement.createActuationUncertaintyStateMachine();
					var actuationUncertainty = coreProfile.getActuationUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(actuationUncertainty) 
						and not (baseElement.isStereotypeApplied(actuationUncertainty))){
						baseElement.applyStereotype(actuationUncertainty);
					}

				}
			}
		}
		fix {
			title : "Generate UncertaintyFamily State in " + baseElement.getQualifiedName()
			do {
				transaction {
					//check if the behaviored classifier defines a state machine or not
					var owned_behaviors = baseElement.getOwnedBehaviors();
					
					/*
					var owned_statemachines = owned_behaviors.select(e|e.type.getName()="StateMachine");
					if(not (owned_statemachines.isEmpty()) ){
						UserInput.inform(baseElement.name + "contains " + owned_statemachines.size().asString() + "state machine(s)");
					}
					*/
					baseElement.createUncertaintyFamilyStateMachine();
					var uncertaintyFamily = coreProfile.getUncertaintyFamilyStereotype();
					
					if(baseElement.isStereotypeApplicable(uncertaintyFamily) 
						and not (baseElement.isStereotypeApplied(uncertaintyFamily))){
						baseElement.applyStereotype(uncertaintyFamily);
					}

				}
			}
		}
		fix {
			title : "Generate GovernanceUncertainty State in " + baseElement.getQualifiedName()
			do {
				transaction {
					//check if the behaviored classifier defines a state machine or not
					var owned_behaviors = baseElement.getOwnedBehaviors();
					
					/*
					var owned_statemachines = owned_behaviors.select(e|e.type.getName()="StateMachine");
					if(not (owned_statemachines.isEmpty()) ){
						UserInput.inform(baseElement.name + "contains " + owned_statemachines.size().asString() + "state machine(s)");
					}
					*/
					baseElement.createGovernanceUncertaintyStateMachine();
					var governanceUncertainty = coreProfile.getGovernanceUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(governanceUncertainty) 
						and not (baseElement.isStereotypeApplied(governanceUncertainty))){
						baseElement.applyStereotype(governanceUncertainty);
					}

				}
			}
		}
		fix {
			title : "Generate DataDeliveryUncertainty State in " + baseElement.getQualifiedName()
			do {
				transaction {
					//check if the behaviored classifier defines a state machine or not
					var owned_behaviors = baseElement.getOwnedBehaviors();
					
					/*
					var owned_statemachines = owned_behaviors.select(e|e.type.getName()="StateMachine");
					if(not (owned_statemachines.isEmpty()) ){
						UserInput.inform(baseElement.name + "contains " + owned_statemachines.size().asString() + "state machine(s)");
					}
					*/
					baseElement.createDataDeliveryUncertaintyStateMachine();
					var dataDeliveryUncertainty = coreProfile.getDataDeliveryUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(dataDeliveryUncertainty) 
						and not (baseElement.isStereotypeApplied(dataDeliveryUncertainty))){
						baseElement.applyStereotype(dataDeliveryUncertainty);
					}

				}
			}
		}
		fix {
			title : "Generate ElasticityUncertainty State in " + baseElement.getQualifiedName()
			do {
				transaction {
					//check if the behaviored classifier defines a state machine or not
					var owned_behaviors = baseElement.getOwnedBehaviors();
					
					/*
					var owned_statemachines = owned_behaviors.select(e|e.type.getName()="StateMachine");
					if(not (owned_statemachines.isEmpty()) ){
						UserInput.inform(baseElement.name + "contains " + owned_statemachines.size().asString() + "state machine(s)");
					}
					*/
					baseElement.createElasticityUncertaintyStateMachine();
					var elasticityUncertainty = coreProfile.getElasticityUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(elasticityUncertainty) 
						and not (baseElement.isStereotypeApplied(elasticityUncertainty))){
						baseElement.applyStereotype(elasticityUncertainty);
					}

				}
			}
		}
		fix {
			title : "Generate ExecutionEnvironmentUncertainty State in " + baseElement.getQualifiedName()
			do {
				transaction {
					//check if the behaviored classifier defines a state machine or not
					var owned_behaviors = baseElement.getOwnedBehaviors();
					
					/*
					var owned_statemachines = owned_behaviors.select(e|e.type.getName()="StateMachine");
					if(not (owned_statemachines.isEmpty()) ){
						UserInput.inform(baseElement.name + "contains " + owned_statemachines.size().asString() + "state machine(s)");
					}
					*/
					baseElement.createExecutionEnvironmentUncertaintyStateMachine();
					var executionEnvironmentUncertainty = coreProfile.getExecutionEnvironmentUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(executionEnvironmentUncertainty) 
						and not (baseElement.isStereotypeApplied(executionEnvironmentUncertainty))){
						baseElement.applyStereotype(executionEnvironmentUncertainty);
					}

				}
			}
		}
		
	}

	critique ownedVirtualUnitsSpecification {
	
		guard {
			var condition = not self.ownedVirtualUnits.isKindOf(Collection);
			return condition;
		} 
		
		check {
			var baseElement = UMLUtil.getBaseElement(self);
			return not self.ownedVirtualUnits.isEmpty();
		}		
		message: "Constraint ownedVirtualUnitsIsDefined failed on VirtualGateway "+ baseElement.getName() +". It causes this uncertainty bla bla bla"		
		fix {
			title : "Create Infrastructure Uncertainty State to " + baseElement.getName()
			do {
				transaction {
					baseElement.createStorageUncertaintyStateMachine();
					var storageUncertainty = coreProfile.getStorageUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(storageUncertainty) 
						and not (baseElement.isStereotypeApplied(storageUncertainty))){
						baseElement.applyStereotype(storageUncertainty);
					}
				}
			}
		}
		fix {
			title : "Create Infrastructure Uncertainty State to " + baseElement.getName()
			do {
				transaction {
					baseElement.createActuationUncertaintyStateMachine();
					var actuationUncertainty = coreProfile.getActuationUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(actuationUncertainty) 
						and not (baseElement.isStereotypeApplied(actuationUncertainty))){
						baseElement.applyStereotype(actuationUncertainty);
					}
				}
			}
		}
		fix {
			title : "Create Infrastructure Uncertainty State to " + baseElement.getName()
			do {
				transaction {
					baseElement.createUncertaintyFamilyStateMachine();
					var uncertaintyFamily = coreProfile.getUncertaintyFamilyStereotype();
					
					if(baseElement.isStereotypeApplicable(uncertaintyFamily) 
						and not (baseElement.isStereotypeApplied(uncertaintyFamily))){
						baseElement.applyStereotype(uncertaintyFamily);
					}
				}
			}
		}
		fix {
			title : "Create Infrastructure Uncertainty State to " + baseElement.getName()
			do {
				transaction {
					baseElement.createGovernanceUncertaintyStateMachine();
					var governanceUncertainty = coreProfile.getGovernanceUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(governanceUncertainty) 
						and not (baseElement.isStereotypeApplied(governanceUncertainty))){
						baseElement.applyStereotype(governanceUncertainty);
					}
				}
			}
		}
		fix {
			title : "Create Infrastructure Uncertainty State to " + baseElement.getName()
			do {
				transaction {
					baseElement.createDataDeliveryUncertaintyStateMachine();
					var dataDeliveryUncertainty = coreProfile.getDataDeliveryUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(dataDeliveryUncertainty) 
						and not (baseElement.isStereotypeApplied(dataDeliveryUncertainty))){
						baseElement.applyStereotype(dataDeliveryUncertainty);
					}
				}
			}
		}
		fix {
			title : "Create Infrastructure Uncertainty State to " + baseElement.getName()
			do {
				transaction {
					baseElement.createElasticityUncertaintyStateMachine();
					var elasticityUncertainty = coreProfile.getElasticityUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(elasticityUncertainty) 
						and not (baseElement.isStereotypeApplied(elasticityUncertainty))){
						baseElement.applyStereotype(elasticityUncertainty);
					}
				}
			}
		}
		fix {
			title : "Create Infrastructure Uncertainty State to " + baseElement.getName()
			do {
				transaction {
					baseElement.createExecutionEnvironmentUncertaintyStateMachine();
					var executionEnvironmentUncertainty = coreProfile.getExecutionEnvironmentUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(executionEnvironmentUncertainty) 
						and not (baseElement.isStereotypeApplied(executionEnvironmentUncertainty))){
						baseElement.applyStereotype(executionEnvironmentUncertainty);
					}
				}
			}
		}
	}
	
	critique ownedUnits_Specification {
	
		guard {
			var condition = self.ownedUnits.isKindOf(Collection);
			return condition;
		}
		
		check {
			var baseElement = UMLUtil.getBaseElement(self);
			return not self.ownedUnits.isEmpty();
		}
		
		message: "Missing ownedUnits on VirtualGateway applied to "+ baseElement.getQualifiedName()		
		fix {
			title : "Generate StorageUncertainty State in " + baseElement.getQualifiedName()
			do {
				transaction {
					//check if the behaviored classifier defines a state machine or not
					var owned_behaviors = baseElement.getOwnedBehaviors();
					
					/*
					var owned_statemachines = owned_behaviors.select(e|e.type.getName()="StateMachine");
					if(not (owned_statemachines.isEmpty()) ){
						UserInput.inform(baseElement.name + "contains " + owned_statemachines.size().asString() + "state machine(s)");
					}
					*/
					baseElement.createStorageUncertaintyStateMachine();
					var storageUncertainty = coreProfile.getStorageUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(storageUncertainty) 
						and not (baseElement.isStereotypeApplied(storageUncertainty))){
						baseElement.applyStereotype(storageUncertainty);
					}

				}
			}
		}
		fix {
			title : "Generate ActuationUncertainty State in " + baseElement.getQualifiedName()
			do {
				transaction {
					//check if the behaviored classifier defines a state machine or not
					var owned_behaviors = baseElement.getOwnedBehaviors();
					
					/*
					var owned_statemachines = owned_behaviors.select(e|e.type.getName()="StateMachine");
					if(not (owned_statemachines.isEmpty()) ){
						UserInput.inform(baseElement.name + "contains " + owned_statemachines.size().asString() + "state machine(s)");
					}
					*/
					baseElement.createActuationUncertaintyStateMachine();
					var actuationUncertainty = coreProfile.getActuationUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(actuationUncertainty) 
						and not (baseElement.isStereotypeApplied(actuationUncertainty))){
						baseElement.applyStereotype(actuationUncertainty);
					}

				}
			}
		}
		fix {
			title : "Generate UncertaintyFamily State in " + baseElement.getQualifiedName()
			do {
				transaction {
					//check if the behaviored classifier defines a state machine or not
					var owned_behaviors = baseElement.getOwnedBehaviors();
					
					/*
					var owned_statemachines = owned_behaviors.select(e|e.type.getName()="StateMachine");
					if(not (owned_statemachines.isEmpty()) ){
						UserInput.inform(baseElement.name + "contains " + owned_statemachines.size().asString() + "state machine(s)");
					}
					*/
					baseElement.createUncertaintyFamilyStateMachine();
					var uncertaintyFamily = coreProfile.getUncertaintyFamilyStereotype();
					
					if(baseElement.isStereotypeApplicable(uncertaintyFamily) 
						and not (baseElement.isStereotypeApplied(uncertaintyFamily))){
						baseElement.applyStereotype(uncertaintyFamily);
					}

				}
			}
		}
		fix {
			title : "Generate GovernanceUncertainty State in " + baseElement.getQualifiedName()
			do {
				transaction {
					//check if the behaviored classifier defines a state machine or not
					var owned_behaviors = baseElement.getOwnedBehaviors();
					
					/*
					var owned_statemachines = owned_behaviors.select(e|e.type.getName()="StateMachine");
					if(not (owned_statemachines.isEmpty()) ){
						UserInput.inform(baseElement.name + "contains " + owned_statemachines.size().asString() + "state machine(s)");
					}
					*/
					baseElement.createGovernanceUncertaintyStateMachine();
					var governanceUncertainty = coreProfile.getGovernanceUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(governanceUncertainty) 
						and not (baseElement.isStereotypeApplied(governanceUncertainty))){
						baseElement.applyStereotype(governanceUncertainty);
					}

				}
			}
		}
		fix {
			title : "Generate DataDeliveryUncertainty State in " + baseElement.getQualifiedName()
			do {
				transaction {
					//check if the behaviored classifier defines a state machine or not
					var owned_behaviors = baseElement.getOwnedBehaviors();
					
					/*
					var owned_statemachines = owned_behaviors.select(e|e.type.getName()="StateMachine");
					if(not (owned_statemachines.isEmpty()) ){
						UserInput.inform(baseElement.name + "contains " + owned_statemachines.size().asString() + "state machine(s)");
					}
					*/
					baseElement.createDataDeliveryUncertaintyStateMachine();
					var dataDeliveryUncertainty = coreProfile.getDataDeliveryUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(dataDeliveryUncertainty) 
						and not (baseElement.isStereotypeApplied(dataDeliveryUncertainty))){
						baseElement.applyStereotype(dataDeliveryUncertainty);
					}

				}
			}
		}
		fix {
			title : "Generate ElasticityUncertainty State in " + baseElement.getQualifiedName()
			do {
				transaction {
					//check if the behaviored classifier defines a state machine or not
					var owned_behaviors = baseElement.getOwnedBehaviors();
					
					/*
					var owned_statemachines = owned_behaviors.select(e|e.type.getName()="StateMachine");
					if(not (owned_statemachines.isEmpty()) ){
						UserInput.inform(baseElement.name + "contains " + owned_statemachines.size().asString() + "state machine(s)");
					}
					*/
					baseElement.createElasticityUncertaintyStateMachine();
					var elasticityUncertainty = coreProfile.getElasticityUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(elasticityUncertainty) 
						and not (baseElement.isStereotypeApplied(elasticityUncertainty))){
						baseElement.applyStereotype(elasticityUncertainty);
					}

				}
			}
		}
		fix {
			title : "Generate ExecutionEnvironmentUncertainty State in " + baseElement.getQualifiedName()
			do {
				transaction {
					//check if the behaviored classifier defines a state machine or not
					var owned_behaviors = baseElement.getOwnedBehaviors();
					
					/*
					var owned_statemachines = owned_behaviors.select(e|e.type.getName()="StateMachine");
					if(not (owned_statemachines.isEmpty()) ){
						UserInput.inform(baseElement.name + "contains " + owned_statemachines.size().asString() + "state machine(s)");
					}
					*/
					baseElement.createExecutionEnvironmentUncertaintyStateMachine();
					var executionEnvironmentUncertainty = coreProfile.getExecutionEnvironmentUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(executionEnvironmentUncertainty) 
						and not (baseElement.isStereotypeApplied(executionEnvironmentUncertainty))){
						baseElement.applyStereotype(executionEnvironmentUncertainty);
					}

				}
			}
		}
		
	}

	critique ownedUnitsSpecification {
	
		guard {
			var condition = not self.ownedUnits.isKindOf(Collection);
			return condition;
		} 
		
		check {
			var baseElement = UMLUtil.getBaseElement(self);
			return not self.ownedUnits.isEmpty();
		}		
		message: "Constraint ownedUnitsIsDefined failed on VirtualGateway "+ baseElement.getName() +". It causes this uncertainty bla bla bla"		
		fix {
			title : "Create Infrastructure Uncertainty State to " + baseElement.getName()
			do {
				transaction {
					baseElement.createStorageUncertaintyStateMachine();
					var storageUncertainty = coreProfile.getStorageUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(storageUncertainty) 
						and not (baseElement.isStereotypeApplied(storageUncertainty))){
						baseElement.applyStereotype(storageUncertainty);
					}
				}
			}
		}
		fix {
			title : "Create Infrastructure Uncertainty State to " + baseElement.getName()
			do {
				transaction {
					baseElement.createActuationUncertaintyStateMachine();
					var actuationUncertainty = coreProfile.getActuationUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(actuationUncertainty) 
						and not (baseElement.isStereotypeApplied(actuationUncertainty))){
						baseElement.applyStereotype(actuationUncertainty);
					}
				}
			}
		}
		fix {
			title : "Create Infrastructure Uncertainty State to " + baseElement.getName()
			do {
				transaction {
					baseElement.createUncertaintyFamilyStateMachine();
					var uncertaintyFamily = coreProfile.getUncertaintyFamilyStereotype();
					
					if(baseElement.isStereotypeApplicable(uncertaintyFamily) 
						and not (baseElement.isStereotypeApplied(uncertaintyFamily))){
						baseElement.applyStereotype(uncertaintyFamily);
					}
				}
			}
		}
		fix {
			title : "Create Infrastructure Uncertainty State to " + baseElement.getName()
			do {
				transaction {
					baseElement.createGovernanceUncertaintyStateMachine();
					var governanceUncertainty = coreProfile.getGovernanceUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(governanceUncertainty) 
						and not (baseElement.isStereotypeApplied(governanceUncertainty))){
						baseElement.applyStereotype(governanceUncertainty);
					}
				}
			}
		}
		fix {
			title : "Create Infrastructure Uncertainty State to " + baseElement.getName()
			do {
				transaction {
					baseElement.createDataDeliveryUncertaintyStateMachine();
					var dataDeliveryUncertainty = coreProfile.getDataDeliveryUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(dataDeliveryUncertainty) 
						and not (baseElement.isStereotypeApplied(dataDeliveryUncertainty))){
						baseElement.applyStereotype(dataDeliveryUncertainty);
					}
				}
			}
		}
		fix {
			title : "Create Infrastructure Uncertainty State to " + baseElement.getName()
			do {
				transaction {
					baseElement.createElasticityUncertaintyStateMachine();
					var elasticityUncertainty = coreProfile.getElasticityUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(elasticityUncertainty) 
						and not (baseElement.isStereotypeApplied(elasticityUncertainty))){
						baseElement.applyStereotype(elasticityUncertainty);
					}
				}
			}
		}
		fix {
			title : "Create Infrastructure Uncertainty State to " + baseElement.getName()
			do {
				transaction {
					baseElement.createExecutionEnvironmentUncertaintyStateMachine();
					var executionEnvironmentUncertainty = coreProfile.getExecutionEnvironmentUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(executionEnvironmentUncertainty) 
						and not (baseElement.isStereotypeApplied(executionEnvironmentUncertainty))){
						baseElement.applyStereotype(executionEnvironmentUncertainty);
					}
				}
			}
		}
	}
	
	critique infrastructureInterface_Specification {
	
		guard {
			var condition = self.infrastructureInterface.isKindOf(Collection);
			return condition;
		}
		
		check {
			var baseElement = UMLUtil.getBaseElement(self);
			return not self.infrastructureInterface.isEmpty();
		}
		
		message: "Missing infrastructureInterface on VirtualGateway applied to "+ baseElement.getQualifiedName()		
		fix {
			title : "Generate StorageUncertainty State in " + baseElement.getQualifiedName()
			do {
				transaction {
					//check if the behaviored classifier defines a state machine or not
					var owned_behaviors = baseElement.getOwnedBehaviors();
					
					/*
					var owned_statemachines = owned_behaviors.select(e|e.type.getName()="StateMachine");
					if(not (owned_statemachines.isEmpty()) ){
						UserInput.inform(baseElement.name + "contains " + owned_statemachines.size().asString() + "state machine(s)");
					}
					*/
					baseElement.createStorageUncertaintyStateMachine();
					var storageUncertainty = coreProfile.getStorageUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(storageUncertainty) 
						and not (baseElement.isStereotypeApplied(storageUncertainty))){
						baseElement.applyStereotype(storageUncertainty);
					}

				}
			}
		}
		fix {
			title : "Generate ActuationUncertainty State in " + baseElement.getQualifiedName()
			do {
				transaction {
					//check if the behaviored classifier defines a state machine or not
					var owned_behaviors = baseElement.getOwnedBehaviors();
					
					/*
					var owned_statemachines = owned_behaviors.select(e|e.type.getName()="StateMachine");
					if(not (owned_statemachines.isEmpty()) ){
						UserInput.inform(baseElement.name + "contains " + owned_statemachines.size().asString() + "state machine(s)");
					}
					*/
					baseElement.createActuationUncertaintyStateMachine();
					var actuationUncertainty = coreProfile.getActuationUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(actuationUncertainty) 
						and not (baseElement.isStereotypeApplied(actuationUncertainty))){
						baseElement.applyStereotype(actuationUncertainty);
					}

				}
			}
		}
		fix {
			title : "Generate UncertaintyFamily State in " + baseElement.getQualifiedName()
			do {
				transaction {
					//check if the behaviored classifier defines a state machine or not
					var owned_behaviors = baseElement.getOwnedBehaviors();
					
					/*
					var owned_statemachines = owned_behaviors.select(e|e.type.getName()="StateMachine");
					if(not (owned_statemachines.isEmpty()) ){
						UserInput.inform(baseElement.name + "contains " + owned_statemachines.size().asString() + "state machine(s)");
					}
					*/
					baseElement.createUncertaintyFamilyStateMachine();
					var uncertaintyFamily = coreProfile.getUncertaintyFamilyStereotype();
					
					if(baseElement.isStereotypeApplicable(uncertaintyFamily) 
						and not (baseElement.isStereotypeApplied(uncertaintyFamily))){
						baseElement.applyStereotype(uncertaintyFamily);
					}

				}
			}
		}
		fix {
			title : "Generate GovernanceUncertainty State in " + baseElement.getQualifiedName()
			do {
				transaction {
					//check if the behaviored classifier defines a state machine or not
					var owned_behaviors = baseElement.getOwnedBehaviors();
					
					/*
					var owned_statemachines = owned_behaviors.select(e|e.type.getName()="StateMachine");
					if(not (owned_statemachines.isEmpty()) ){
						UserInput.inform(baseElement.name + "contains " + owned_statemachines.size().asString() + "state machine(s)");
					}
					*/
					baseElement.createGovernanceUncertaintyStateMachine();
					var governanceUncertainty = coreProfile.getGovernanceUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(governanceUncertainty) 
						and not (baseElement.isStereotypeApplied(governanceUncertainty))){
						baseElement.applyStereotype(governanceUncertainty);
					}

				}
			}
		}
		fix {
			title : "Generate DataDeliveryUncertainty State in " + baseElement.getQualifiedName()
			do {
				transaction {
					//check if the behaviored classifier defines a state machine or not
					var owned_behaviors = baseElement.getOwnedBehaviors();
					
					/*
					var owned_statemachines = owned_behaviors.select(e|e.type.getName()="StateMachine");
					if(not (owned_statemachines.isEmpty()) ){
						UserInput.inform(baseElement.name + "contains " + owned_statemachines.size().asString() + "state machine(s)");
					}
					*/
					baseElement.createDataDeliveryUncertaintyStateMachine();
					var dataDeliveryUncertainty = coreProfile.getDataDeliveryUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(dataDeliveryUncertainty) 
						and not (baseElement.isStereotypeApplied(dataDeliveryUncertainty))){
						baseElement.applyStereotype(dataDeliveryUncertainty);
					}

				}
			}
		}
		fix {
			title : "Generate ElasticityUncertainty State in " + baseElement.getQualifiedName()
			do {
				transaction {
					//check if the behaviored classifier defines a state machine or not
					var owned_behaviors = baseElement.getOwnedBehaviors();
					
					/*
					var owned_statemachines = owned_behaviors.select(e|e.type.getName()="StateMachine");
					if(not (owned_statemachines.isEmpty()) ){
						UserInput.inform(baseElement.name + "contains " + owned_statemachines.size().asString() + "state machine(s)");
					}
					*/
					baseElement.createElasticityUncertaintyStateMachine();
					var elasticityUncertainty = coreProfile.getElasticityUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(elasticityUncertainty) 
						and not (baseElement.isStereotypeApplied(elasticityUncertainty))){
						baseElement.applyStereotype(elasticityUncertainty);
					}

				}
			}
		}
		fix {
			title : "Generate ExecutionEnvironmentUncertainty State in " + baseElement.getQualifiedName()
			do {
				transaction {
					//check if the behaviored classifier defines a state machine or not
					var owned_behaviors = baseElement.getOwnedBehaviors();
					
					/*
					var owned_statemachines = owned_behaviors.select(e|e.type.getName()="StateMachine");
					if(not (owned_statemachines.isEmpty()) ){
						UserInput.inform(baseElement.name + "contains " + owned_statemachines.size().asString() + "state machine(s)");
					}
					*/
					baseElement.createExecutionEnvironmentUncertaintyStateMachine();
					var executionEnvironmentUncertainty = coreProfile.getExecutionEnvironmentUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(executionEnvironmentUncertainty) 
						and not (baseElement.isStereotypeApplied(executionEnvironmentUncertainty))){
						baseElement.applyStereotype(executionEnvironmentUncertainty);
					}

				}
			}
		}
		
	}

	critique infrastructureInterfaceSpecification {
	
		guard {
			var condition = not self.infrastructureInterface.isKindOf(Collection);
			return condition;
		} 
		
		check {
			var baseElement = UMLUtil.getBaseElement(self);
			return not self.infrastructureInterface.isEmpty();
		}		
		message: "Constraint infrastructureInterfaceIsDefined failed on VirtualGateway "+ baseElement.getName() +". It causes this uncertainty bla bla bla"		
		fix {
			title : "Create Infrastructure Uncertainty State to " + baseElement.getName()
			do {
				transaction {
					baseElement.createStorageUncertaintyStateMachine();
					var storageUncertainty = coreProfile.getStorageUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(storageUncertainty) 
						and not (baseElement.isStereotypeApplied(storageUncertainty))){
						baseElement.applyStereotype(storageUncertainty);
					}
				}
			}
		}
		fix {
			title : "Create Infrastructure Uncertainty State to " + baseElement.getName()
			do {
				transaction {
					baseElement.createActuationUncertaintyStateMachine();
					var actuationUncertainty = coreProfile.getActuationUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(actuationUncertainty) 
						and not (baseElement.isStereotypeApplied(actuationUncertainty))){
						baseElement.applyStereotype(actuationUncertainty);
					}
				}
			}
		}
		fix {
			title : "Create Infrastructure Uncertainty State to " + baseElement.getName()
			do {
				transaction {
					baseElement.createUncertaintyFamilyStateMachine();
					var uncertaintyFamily = coreProfile.getUncertaintyFamilyStereotype();
					
					if(baseElement.isStereotypeApplicable(uncertaintyFamily) 
						and not (baseElement.isStereotypeApplied(uncertaintyFamily))){
						baseElement.applyStereotype(uncertaintyFamily);
					}
				}
			}
		}
		fix {
			title : "Create Infrastructure Uncertainty State to " + baseElement.getName()
			do {
				transaction {
					baseElement.createGovernanceUncertaintyStateMachine();
					var governanceUncertainty = coreProfile.getGovernanceUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(governanceUncertainty) 
						and not (baseElement.isStereotypeApplied(governanceUncertainty))){
						baseElement.applyStereotype(governanceUncertainty);
					}
				}
			}
		}
		fix {
			title : "Create Infrastructure Uncertainty State to " + baseElement.getName()
			do {
				transaction {
					baseElement.createDataDeliveryUncertaintyStateMachine();
					var dataDeliveryUncertainty = coreProfile.getDataDeliveryUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(dataDeliveryUncertainty) 
						and not (baseElement.isStereotypeApplied(dataDeliveryUncertainty))){
						baseElement.applyStereotype(dataDeliveryUncertainty);
					}
				}
			}
		}
		fix {
			title : "Create Infrastructure Uncertainty State to " + baseElement.getName()
			do {
				transaction {
					baseElement.createElasticityUncertaintyStateMachine();
					var elasticityUncertainty = coreProfile.getElasticityUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(elasticityUncertainty) 
						and not (baseElement.isStereotypeApplied(elasticityUncertainty))){
						baseElement.applyStereotype(elasticityUncertainty);
					}
				}
			}
		}
		fix {
			title : "Create Infrastructure Uncertainty State to " + baseElement.getName()
			do {
				transaction {
					baseElement.createExecutionEnvironmentUncertaintyStateMachine();
					var executionEnvironmentUncertainty = coreProfile.getExecutionEnvironmentUncertaintyStereotype();
					
					if(baseElement.isStereotypeApplicable(executionEnvironmentUncertainty) 
						and not (baseElement.isStereotypeApplied(executionEnvironmentUncertainty))){
						baseElement.applyStereotype(executionEnvironmentUncertainty);
					}
				}
			}
		}
	}
	
}

	

